vars:
  resource_type: &resource_type terraform.aws_lambda_function
  policy_meta: &policy_meta
    description: |
      Identifies Lambda Functions which are either missing required
      tags or have incorrect required tag values.
    metadata:
      category:
      - tagging
      creator: Stacklet
      severity: LOW
      classification:
      - pillar: operations
        segment: tagging
        scope: default
        severity: LOW
  filters: &filters
    - or:
      - "tag:Name": empty
      - "tag:Owner": empty
      - "tag:EUID": empty
      - "tag:Service": empty
      - "tag:Contact": empty
      # - not:
      #   - type: value
      #     key: "tag:Contact"
      #     op: regex
      #     value: (^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$) #Checks for a value of an email address.

policies:
- name: aws-lambda-invalid-tags-iac
  <<: *policy_meta
  resource: *resource_type
  filters: *filters
